!function(t,n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof exports?module.exports=n(require("jquery")):n(t.jQuery)}(this,function(t){"use strict";t.fn.editrowform=function(n){var e,o=Array.prototype.slice.call(arguments,1),i=this;return this.each(function(r,u){var a=t(u),d=a.data("editrowform");"string"==typeof n?d&&t.isFunction(d[n])&&(e=d[n].apply(d,o),r||(i=e)):d||(d=new t.editrowform(u,n))}),i},t.editrowform=function(n,e){function o(){if(X.$el.data("editrowform",X),X.options=t.extend({},t.editrowform.defaultOptions,e),W(),X.options.click){var n=t("tr td",X.el).parent();n.dblclick(function(t){i(this)}),n.click(function(t){r(this)})}X.options.hideOnBlur&&t(document).click(function(n){var e=t(n.target).closest(it).length,o=t(n.target).closest(X.el).length;e||o||Y||E(),Y=!1}),t(window).resize(function(){q(at)})}function i(n){E(),h(t(n).index())}function r(n){ct.isHidden(it)||(E(),h(t(n).index()))}function u(){return rt}function a(){var t=x().saveButtonTimeout;ct.isNotEmpty(t)&&ct.timeoutButton(st.getSaveButtonId(),t);for(var n,e=!0,o=[],i=0;i<T();i++)n=A(i),o.push(n);var r=x().onSave;ct.functionExists(r)&&(e=r(rt,dt,at,o)),(e||ct.isEmpty(e))&&(m(dt,o),E())}function d(){var t=x().cancelButtonTimeout;ct.isNotEmpty(t)&&ct.timeoutButton(st.getCancelButtonId(),t);var n=!0,e=x().onCancel;ct.functionExists(e)&&(n=e(rt,dt,at)),(n||ct.isEmpty(n))&&E()}function s(t){var n,e=!0,o=V();n=t!==!0&&!ct.isEmpty(t)||0===o?t===!0||t===!1||ct.isEmpty(t)?p():c(ct.functionExists(t)?t():t):l();var u=x().onAddRow;return ct.functionExists(u)&&(e=u(o,n)),!e&&!ct.isEmpty(e)||ct.isEmpty(n)?!1:(x().click&&(n.dblclick(function(t){i(this)}),n.click(function(t){r(this)})),n.appendTo(X.$el),o)}function c(n){return t(n).clone()}function l(){var n=(V(),b(V()-1)),e=t(n).clone();return e.prop("id",""),t("td",e).each(function(n,e){var o=ot[n];o.ignore||t(this).html("&nbsp;")}),e}function p(){for(var n,e=T(),o=t(pt.tr),i=0;e>i;i++)n=t(pt.td),n.appendTo(o),n.html("&nbsp;");return o}function f(t){if(B(t)){var n=!0,e=b(t),o=x().onDeleteRow;ct.functionExists(o)&&(n=o(t,e)),!n&&!ct.isEmpty(n)||ct.isEmptyArray(e)||e.remove()}}function m(t,n){if(B(t))for(var e=0;e<T();e++)G(e)||J(e)||N(t,e,n[e])}function v(t){Y=!0,h(t)}function h(t){if(B(t)&&null!==it){U(t);var n=b(t);q(n),R(t),it.show(),z(),x().focusOnInput&&y(),at=n,dt=t}}function y(){t("input",it).each(function(n,e){var o=t(e).prop("disabled");return o?void 0:(t(e).focus(),!1)})}function E(){if(null!==it&&!ct.isHidden(it)){it.hide();var t=x().onHide;ct.functionExists(t)&&t(rt,dt,at)}}function g(){X.$el.removeData("editrowform"),it&&(it.remove(),it=null)}function x(){return X.options}function I(){var n=t("thead tr",X.el);return ct.isNotEmpty(n)?n:t("th",X.el).parent()}function w(n){var e,o=I();return ct.isNotEmpty(o)&&(e=t("th",o)[n]),e}function b(n){return t("tbody tr",X.el).eq(n)}function C(n,e){var o,i=b(n);return ct.isNotEmpty(i)&&(o=t("td",i)[e]),o}function k(n,e){var o,i=C(n,e),r=L(e),u=t("input",i);o=ct.isEmptyArray(u)?t(i).text().trim():lt.getValue(u,r);var a=x().getCellValue;return ct.functionExists(a)&&(o=a(n,e,o,b(n),i)),o}function N(n,e,o){var i,r=L(e),u=C(n,e),a=x().setCellValue;ct.functionExists(a)?a(n,e,o,b(n),u):(i=t("input",u),ct.isEmptyArray(i)?t(u).text(o):lt.setValue(i,r,o))}function T(){var n=I();return ct.isEmptyArray(n)?t("td",b(0)).length:t("th",n).length}function V(){return t("tbody tr",X.el).length}function B(t){return ct.isEmpty(t)?!1:isNaN(t)?!1:0>t||t>=V()?!1:!0}function R(t){for(var n=0;n<T();n++)F(t,n,k(t,n))}function F(n,e,o){var i,r,u=st.getInputId(e),a=(b(n),x().setInputValue);ct.functionExists(a)?a(n,e,o,u,rt,b(n),C(n,e),w(e)):(i=L(e),r=t("."+tt+e,rt),lt.setValue(r,i,o))}function A(n){var e,o=t("."+tt+n,rt);ct.isEmptyArray(o)||(e=lt.getValue(o,L(n)));var i=x().getInputValue;return ct.functionExists(i)&&(e=i(dt,n,e,st.getInputId(n),rt,at,C(dt,n),w(n))),e}function S(n){if(!J(n)){var e=st.getInputId(n),o=st.getInputName(n),i=lt.createInput(e,o,L(n)),r=K(n);ct.isNotEmpty(r)&&i.val(r),G(n)&&i.prop("disabled",!0);var u=x().renderInput;return ct.functionExists(u)&&(i=u(i,dt,n,w(n))),i&&t(i).addClass(tt+n),i}}function W(){O(),H()}function O(){var n,e,o=X.options.columns,i=0,r={};for(i=0;i<T();i++)r[i]=ct.clone(X.options.defaultColumn);if(ct.isNotEmpty(o)&&t.isArray(o))for(i=0;i<o.length;i++)n=o[i],ct.isNotEmpty(n)&&(e=n.colIndex,ct.isEmpty(e)&&(e=i),r[e]=n);ot=r}function H(){var n=t(pt.div);n.prop("id",st.getEditRowFormId()),n.addClass(_),n.addClass(x().cssClass),n.hide(),n.appendTo(document.body);var e=t(pt.form);e.prop("id",st.getFormId()),e.prop("tabindex",0),e.addClass("form"),e.appendTo(n);var o=D();o.appendTo(e);var i=j();i.appendTo(n),e.submit(function(t){t.preventDefault(),a()}),ut=i,it=n,rt=e}function D(){var n=t(pt.div);n.prop("id",st.getFormRowId()),n.addClass("row");for(var e=null,o=0;o<T();o++)e=$(o),e.appendTo(n);return n}function $(n){var e=t(pt.div);e.prop("id",st.getFormCellId(n)),e.addClass("cell"),e.addClass(nt+n);var o=S(n);return o&&o.appendTo(e),e}function j(){var n=t(pt.div),e=t(pt.button);e.prop("id",st.getSaveButtonId()),e.addClass("save"),e.appendTo(n),e.text(x().saveText),e.on("click",a);var o=t(pt.button);o.prop("id",st.getCancelButtonId()),o.addClass("cancel"),o.appendTo(n),o.text(x().cancelText),o.on("click",d);var i=t(pt.div);return i.addClass("save-and-cancel-bar"),i.addClass("button-bar"),n.appendTo(i),i}function q(n){if(!ct.isEmpty(n)){var e=t(n).offset();ct.position(it,e.top,e.left)}}function z(){var n=t(ut).innerWidth(),e=X.$el.innerWidth(),o=(e-n)/2;ut.css({left:o,position:"absolute"})}function L(n){var e=ot[n].type;return"datepicker"!==e||t.datepicker?ct.isNotEmpty(e)?e:Q(n):et}function Q(n){var e=C(0,n),o=t("input, select, textarea",e).prop("type");return ct.isNotEmpty(o)&&-1!=o.indexOf("select")?"select":ct.isNotEmpty(o)?o:et}function G(t){var n=ot[t].disabled;return ct.isNotEmpty(n)?ct.toBoolean(n):!1}function J(t){var n=ot[t].ignore;return ct.isNotEmpty(n)?ct.toBoolean(n):!1}function K(t){return ot[t].defaultValue}function M(n){var e=w(n);if(ct.isNotEmpty(e)){{t(e).innerWidth(),t(e).innerWidth()}return t(e).innerWidth()}var o=C(dt,n);return ct.isNotEmpty(o)?t(o).innerWidth():0}function P(n){var e=b(n);return ct.isNotEmpty(e)?t(e).outerHeight():0}function U(n){it.width(ct.getWidth(X.el));var e=P(n);t(".row",it).height(e),t(".row .cell",it).height(e);for(var o=0;o<T();o++){var i=t("."+nt+o,it),r=M(o);i.width(r);var u=L(o);"checkbox"!==u&&t("."+tt+o,i).width(r-Z)}}var X=this;X.$el=t(n),X.el=n,X.save=a,X.addRow=s,X.deleteRow=f,X.setRowValues=m,X.show=v,X.hide=E,X.destroy=g,X.getRowCount=V,X.getColumnCount=T,X.getForm=u;var Y,Z=4,_="erf",tt="input-",nt="cell-",et="text",ot={},it=null,rt=null,ut=null,at=null,dt=null,st={idSuffix:"-erf",getEditRowFormId:function(t){var n=X.options.id;return ct.isEmpty(n)&&(n=X.el.id),ct.isEmpty(n)&&(n="no-id-"+(new Date).getTime()),n+this.idSuffix},getInputId:function(t){var n=ot[t].id;return ct.isNotEmpty(n)?n:this.getEditRowFormId()+"-input"+t},getInputName:function(n){var e=ot[n].name;if(ct.isNotEmpty(e))return e;if(e=ot[n].id,ct.isNotEmpty(e))return e;var o=w(n);return e=t(o).text().trim(),ct.isNotEmpty(e)?e:this.getEditRowFormId()+"-input"+n},getFormCellId:function(t){return this.getEditRowFormId()+"-cell-"+t},getFormRowId:function(){return this.getEditRowFormId()+"-row"},getFormId:function(){return this.getEditRowFormId()+"-form"},getSaveButtonId:function(){return this.getEditRowFormId()+"-save"},getCancelButtonId:function(){return this.getEditRowFormId()+"-cancel"}},ct={timeoutButton:function(n,e){e||(e=1e3);var o="#"+n;t(o).prop("disabled",!0),setTimeout(function(){t(o).prop("disabled",!1)},e)},functionExists:function(n){return"undefined"!=typeof n&&t.isFunction(n)},isEmptyArray:function(t){return this.isEmpty(t)?!0:"undefined"!=typeof t.length?0===t.length:!0},isEmpty:function(n){return void 0===n||null===n||"undefined"==typeof n||"null"==t.trim(n)||""===t.trim(n)},isNotEmpty:function(t){return!this.isEmpty(t)},getWidth:function(n){return t(n).width()},clone:function(n){return t.extend(!0,{},n)},isHidden:function(n){return"none"==t(n).css("display")},position:function(n,e,o){t(n).css({top:e,left:o,position:"absolute"})},toBoolean:function(t){return this.isEmpty(t)?!1:t===!0||t===!1?t:(t=t.toLowerCase(),"y"==t||"true"==t||"yes"==t||"1"==t?!0:!1)}},lt={createInput:function(n,e,o){var i;return"checkbox"==o?(i=t(pt.checkbox),i.prop("id",n),i.prop("name",e)):"datepicker"==o?(i=t(pt.textfield),i.prop("id",n),i.prop("name",e),t(i).datepicker()):(i=t(pt.textfield),i.prop("id",n),i.prop("name",e)),i},getValue:function(n,e){return"checkbox"==e?this.getCheckboxValue(n):t(n).val()},setValue:function(n,e,o){"checkbox"==e?this.setCheckboxValue(n,o):t(n).val(o)},getCheckboxValue:function(n){return t(n).prop("checked")},setCheckboxValue:function(n,e){t(n).prop("checked",ct.toBoolean(e))}},pt={table:"<table />",tr:"<tr />",td:"<td />",div:"<div />",form:"<form />",button:"<button />",textfield:'<input type="text" />',checkbox:'<input type="checkbox" />'};o()},t.editrowform.defaultOptions={id:"",cssClass:"",click:!0,saveText:"Save",cancelText:"Cancel",saveButtonTimeout:"",cancelButtonTimeout:"",hideOnBlur:!0,focusOnInput:!1,columns:"",defaultColumn:{colIndex:"",id:"",name:"",type:"",disabled:"",ignore:"",defaultValue:""},onSave:"",onCancel:"",onHide:"",onDeleteRow:"",onAddRow:"",getCellValue:"",setCellValue:"",getInputValue:"",setInputValue:"",renderInput:""}});